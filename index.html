<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NE Scanner</title>

    <!-- ‡πÇ‡∏´‡∏•‡∏î QuaggaJS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        button {
            width: 100%;
            padding: 15px;
            margin-top: 10px;
            font-size: 18px;
            border-radius: 10px;
            border: none;
            background: green;
            color: white;
        }
        #scanner-container {
            width: 100%;
            height: 300px;
            display: none;
            margin-top: 20px;
            background: black;
        }
    </style>
</head>

<body>

    <h2>üì¶ NE Scanner</h2>

    <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å -->
    <input id="barcode" placeholder="Barcode" style="width:100%; padding:10px; font-size:18px; margin-bottom:10px;">

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏™‡πÅ‡∏Å‡∏ô‡∏Å‡∏•‡πâ‡∏≠‡∏á -->
    <button id="scanBtn">üì∑ Scan Barcode</button>

    <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ -->
    <button id="uploadBtn" style="background:#444;">üñº Upload Barcode Image</button>

    <!-- input file ‡∏ã‡πà‡∏≠‡∏ô -->
    <input id="uploadInput" type="file" accept="image/*" style="display:none;">

    <!-- ‡∏Å‡∏•‡πâ‡∏≠‡∏á -->
    <div id="scanner-container">
        <div id="scanner" style="width:100%; height:100%;"></div>
    </div>

    <!-- SCRIPT MAIN -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const barcodeInput = document.getElementById("barcode");
            const scanBtn = document.getElementById("scanBtn");
            const uploadBtn = document.getElementById("uploadBtn");
            const uploadInput = document.getElementById("uploadInput");
            const scannerContainer = document.getElementById("scanner-container");

            // ===== ‡∏™‡πÅ‡∏Å‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏•‡πâ‡∏≠‡∏á =====
            scanBtn.addEventListener("click", () => {
                scannerContainer.style.display = "block";

                Quagga.init({
                    inputStream: {
                        name: "Live",
                        type: "LiveStream",
                        target: document.querySelector("#scanner"),
                        constraints: { facingMode: "environment" }
                    },
                    decoder: {
                        readers: ["ean_reader", "ean_13_reader", "upc_reader", "code_128_reader"]
                    }
                }, err => {
                    if (err) {
                        alert("‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ");
                        console.log(err);
                        return;
                    }
                    Quagga.start();
                });

                Quagga.onDetected(result => {
                    if (!result.codeResult) return;

                    const code = result.codeResult.code;
                    barcodeInput.value = code;
                    alert("‚úî Scan ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + code);

                    Quagga.stop();
                    scannerContainer.style.display = "none";
                });
            });

            // ===== ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ =====
            uploadBtn.addEventListener("click", () => uploadInput.click());

            uploadInput.addEventListener("change", event => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = function () {
                    Quagga.decodeSingle({
                        src: reader.result,
                        numOfWorkers: 0,
                        inputStream: { size: 800 },
                        decoder: {
                            readers: ["ean_reader", "ean_13_reader", "upc_reader", "code_128_reader"]
                        }
                    }, result => {
                        if (result && result.codeResult) {
                            const code = result.codeResult.code;
                            barcodeInput.value = code;
                            alert("‚úî ‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: " + code);
                        } else {
                            alert("‚ùå ‡∏≠‡πà‡∏≤‡∏ô‡∏ö‡∏≤‡∏£‡πå‡πÇ‡∏Ñ‡πâ‡∏î‡∏à‡∏≤‡∏Å‡∏£‡∏π‡∏õ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ");
                        }
                    });
                };
                reader.readAsDataURL(file);
            });

        });
    </script>

</body>
</html>
